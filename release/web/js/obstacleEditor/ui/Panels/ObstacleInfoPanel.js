function ObstacleInfoPanelScript(t){function e(t){this._user.getSelectedObstacle().setName(t.text)}function n(t,e){this.addRoutePoint(e)}function i(t,e){this.removeRoutePoint(e)}function s(t,e){e===this._user.getSelectedObstacle()&&this.setObstacleInfo(e)}function a(t,e){this._user.getSelectedRoutePoint()==t?this._mainPanel.mapPanel.putRoutePointToMapCenter(t):this._user.selectRoutePoint(t)}function o(t,e){t.obstacle.removeRoutePoint(t)}this.updateRoutePointItem=function(t){null!=t&&-1!=t.index&&this.routePointList.changeItem(t.index,{routePoint:t})},this.refreshPanel=function(){var t=this._user.isObstacleSelected(),e=this._user.isMainCarSelected();t||e?(this.contentPanel.visible=!0,this.obstacleBaseInfoPanel.visible=t,this.mainCarBaseInfoPanel.visible=e):this.contentPanel.visible=!1},this.setObstacleInfo=function(t){null!=t&&(this.typeComboBox.selectedLabel=t.type,this.nameInput.text=t.name,this.setRoutePoints(t.route))},this.setMainCarInfo=function(){var t=this._obstacleManager.getMainCar();this.timeLimitInput.text=t.timeLimit;this._user.getSelectedRoutePoint()},this.changeObstacle=function(t,e){null!=e&&(e.unregisterEvent(ObstacleEvent.ROUTE_POINT_ADDED,this,n),e.unregisterEvent(ObstacleEvent.ROUTE_POINT_REMOVED,this,i),e.unregisterEvent(ObjectEvent.VALUE_CHANGED,this,s)),null!=t&&(t.registerEvent(ObstacleEvent.ROUTE_POINT_ADDED,this,n),t.registerEvent(ObstacleEvent.ROUTE_POINT_REMOVED,this,i),t.registerEvent(ObjectEvent.VALUE_CHANGED,this,s)),this.setObstacleInfo(t),this.refreshPanel()},this.refreshRoutePointList=function(){this.routePointList.refresh()},this.clearRoutePoint=function(){this.routePointList.array=[]},this.setRoutePoints=function(t){this.routePointList.array=[];for(var e=0;e<t.points.length;e++)this.addRoutePoint(t.points[e],e,!1);this.refreshRoutePointList()},this.addRoutePoint=function(t,e=!0){var n=t.index;e?this.routePointList.addItemAt({routePoint:t},n):this.routePointList.array.splice(n,0,{routePoint:t})},this.removeRoutePoint=function(t){this.routePointList.deleteItem(t.index)},ObstacleInfoPanelScript.super(this),DependencesHelper.setDependences(this,t),this._loadedDataManager.registerEvent(LoadedDataManagerEvent.MAP_DATA_LOADED,this,function(){UIHelper.setComboLabels(this.typeComboBox,this._loadedDataManager.mapData.getObstacleTypes())}),this.routePointList.renderHandler=new Handler(this,function(t,e){t.label="point"+e;var n=t.dataSource.routePoint,i=n===this._user.getSelectedRoutePoint(),s=t.getChildByName("selectedMark");null!=s&&(s.visible=i),t.on(Event.CLICK,this,a,[n]),t.on(Event.RIGHT_CLICK,this,o,[n])}),this.addRoutePointButton.on(Event.CLICK,this,function(t){var e=this._user.getSelectedObstacle(),n=null;if(0==e.getRoutePointCount()){var i=new Pose,s=this._mainPanel.mapPanel.mainContainer.hScrollBar.value,a=this._mainPanel.mapPanel.mainContainer.vScrollBar.value;s+=this._mainPanel.mapPanel.mainContainer.width/2,a+=this._mainPanel.mapPanel.mainContainer.height/2;var o=this._loadedDataManager.mapData.uiToMapPosition({x:s,y:a});i.vec3.x=o.x,i.vec3.y=o.y,n=new RoutePoint2D(this._loadedDataManager.mapData,i),e.addRoutePoint(n)}else{var r=this._user.getSelectedRoutePoint();if(null==r)n=e.getRoutePoint(e.getRoutePointCount()-1).clone(),e.addRoutePoint(n);else{var l=r.index;n=r.clone(),e.addRoutePoint(n,l+1)}}this._user.selectRoutePoint(n)}),this.typeComboBox.on(Event.CHANGE,this,function(t){var e=t.currentTarget;this._user.getSelectedObstacle().setType(e.selectedLabel)}),this.nameInput.on(Event.ENTER,this,e),this.nameInput.on(Event.BLUR,this,e),this._user.registerEvent(UserEvent.OBSTACLE_SELECTED,this,function(t,e,n){this.changeObstacle(e,n)}),this._user.registerEvent(UserEvent.MAIN_CAR_SELECTED,this,function(t,e){this.refreshPanel()}),this._user.registerEvent(UserEvent.ROUTE_POINT_SELECTED,this,function(t,e,n){this.updateRoutePointItem(n),this.updateRoutePointItem(e)}),this.changeObstacle(this._user.getSelectedObstacle(),null)}Laya.class(ObstacleInfoPanelScript,"ObstacleInfoPanelScript",ObstacleInfoPanelUI);