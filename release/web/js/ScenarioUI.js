function ScenarioUI(e,t){ScenarioUI.super(this),this.initSelectSceneUI(),this.initScenarioListUI(),this.pageChooser=e,this.modalBlocker=new ModalBlocker(this),this.bannerControl=new BannerControl(e,{m_uiBanner_logo:this.m_uiBanner_logo,m_uiBanner_home:this.m_uiBanner_home,m_uiBanner_setup:this.m_uiBanner_setup,m_uiBanner_scene:this.m_uiBanner_scene,m_uiBanner_scenario:this.m_uiBanner_scenario}),this.sensorControl=new SensorControl(e,t,{m_uiSensorButton1:this.m_uiSensorButton1,m_uiSensorButton2:this.m_uiSensorButton2,m_uiSensorButton3:this.m_uiSensorButton3,m_uiSensorList:this.m_uiSensorList}),this.drivingControl=new DrivingControl(t,{m_uiDriveButton1:this.m_uiDriveButton1,m_uiDriveButton2:this.m_uiDriveButton2,m_uiDriveButton3:this.m_uiDriveButton3,m_uiDrive_speed:this.m_uiDrive_speed,m_uiDrive_accer:this.m_uiDrive_accer,m_uiDrive_steerSlider:this.m_uiDrive_steerSlider,m_uiDrive_steerImage:this.m_uiDrive_steerImage}),this.initDrivingControlUI(),this.client=t.on("case_list",this,function(){this.refreshScenarioListUI()}).on("scene_list",this,function(){this.refreshSelectSceneUI()}).on("loading",this,function(){this.modalBlocker.resume()})}Laya.class(ScenarioUI,"ScenarioUI",ScenarioPageUI),ScenarioUI.prototype.refreshSelectSceneUI=function(){var e=[],t=new Set(["IndustrialCity","Parking"]),i=this.client.data.scene_list.data;for(var n of i){var s=n.scene,r=t.has(s);e.push({sceneName:s,label:{text:s+(r?"":" (DISABLED)")},image:{skin:n.image,gray:!r},sceneValid:r})}this.selectSceneList.array=e},ScenarioUI.prototype.initSelectSceneUI=function(){this.selectScenePanel.visible=!1,this.selectScenePanel.getChildByName("cancelButton").on(Event.CLICK,this,function(){this.selectScenePanel.visible=!1}),this.selectSceneList.mouseHandler=new Handler(this,function(e){if(e.type==Event.CLICK&&e.target.dataSource.sceneValid){var t=e.target.dataSource.sceneName;this.client.case.insertDefault(t),this.client.storeCases(),this.refreshScenarioListUI(),this.selectScenePanel.visible=!1,this.m_uiScenarioList.selectedIndex=this.m_uiScenarioList.array.length-1}})},ScenarioUI.prototype.initScenarioListUI=function(){function e(e,t){this.pageChooser.sensorChart.background();var i=new AskPopupWindowScript("Do you want to delete\n[{0}]?".format(e),this,function(){this.client.case.removeCase(e),this.client.storeCases(),this.refreshScenarioListUI();var t=this.m_uiScenarioList.selectedIndex;this.m_uiScenarioList.selectedIndex=-1,this.m_uiScenarioList.selectedIndex=t},function(){});i.popup(),i.closeHandler=new Laya.Handler(this,function(e){this.pageChooser.sensorChart.foreground()})}function t(e,t){this.pageChooser.sensorChart.background();var i=Object.assign({},this.client.case.getSelectedCase()),n=new ObstacleEditor;n.createMainUI(this),n.registerEvent(ObstacleEditorEvent.USER_SAVE_CASE,this,function(e,t){i.content=t,this.client.case.insert(i),this.client.storeCases()}),n.registerEvent(ObstacleEditorEvent.USER_CLOSE_EDITOR,this,function(e,t){this.pageChooser.sensorChart.foreground()}),n.loadMapData(i.scene,i.scene_config),n.loadCaseData(i.content)}function i(e){null==e?this.client.case.selectCase(null):this.client.case.selectCase(e.name)}this.m_uiScenarioList.array=[],this.m_uiScenarioList.renderHandler=new Handler(this,function(i,n){var s=this.client.case.getList(),r=i.getChildByName("label"),o=i.getChildByName("editButton"),a=i.getChildByName("removeButton"),c=i.getChildByName("selectedMark"),l=s[n].name,h=l==this.client.case.getSelectedCaseId();r.text=s[n].name,o.visible=h,c.visible=h,a.visible=h,o.on(Event.CLICK,this,t,[l]),a.on(Event.CLICK,this,e,[l])}),this.m_uiScenarioList.on(Laya.Event.CHANGE,this,function(){var e=this.client.case.getList();if(-1==this.m_uiScenarioList.selectedIndex)i.call(this,null);else{var t=e[this.m_uiScenarioList.selectedIndex];i.call(this,t)}}),this.m_uiScenarioButton.on(Laya.Event.CLICK,this,function(){this.selectScenePanel.visible=!0})},ScenarioUI.prototype.initDrivingControlUI=function(){this.drivingControl.on(DrivingControl.BEFORE_START,this,function(){var e=this.client.case.getSelectedCase();e&&(this.client.data.scene_info.scene!==e.scene&&(this.client.data.scene_info.scene=e.scene),this.client.send("scene_info"),this.modalBlocker.block(),this.client.sendCase(e))})},ScenarioUI.prototype.refreshScenarioListUI=function(){var e=[];this.client.case.getList().forEach(function(t,i){e.push({label:{text:t.name}})}),this.m_uiScenarioList.array=e};