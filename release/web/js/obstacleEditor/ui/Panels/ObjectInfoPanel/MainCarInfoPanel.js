function MainCarInfoPanelScript(t){function e(t){this._mainCar.setValue("timeLimit",Number(t.text))}function i(t,e){this._user.getSelectedRoutePoint()==t?this._mainPanel.mapPanel.putRoutePointToMapCenter(t):this._user.selectRoutePoint(t)}function n(t,e){t.getOwner().removeRoutePoint(t)}this._changePoint=function(t,e){this._markPointButton(this.mainCarStartPointButton,null!=t&&t.pointType==ObjectPointType.MAIN_CAR_START_POINT),this.updateRoutePointItem(e),this.updateRoutePointItem(t)},this._markPointButton=function(t,e){t.getChildByName("selectedMark").visible=e},this.updateRoutePointItem=function(t){null!=t&&t.pointType==ObjectPointType.MAIN_CAR_ROUTE_POINT&&this.routePointList.changeItem(t.index,{routePoint:t})},this.refreshPanel=function(){var t=this._user.isMainCarSelected();this.visible=t},this.setMainCarInfo=function(){this.setMainCarBaseInfo(),this.setRoutePoints()},this.setMainCarBaseInfo=function(){this.timeLimitInput.text=this._mainCar.timeLimit},this.setRoutePoints=function(){var t=this._mainCar.getRoutePoints();this.routePointList.array=[];for(var e=0;e<t.length;e++)this.addRoutePoint(t[e],e,!1);this.refreshRoutePointList()},this.refreshRoutePointList=function(){this.routePointList.refresh()},this.addRoutePoint=function(t,e=!0){var i=t.index;e?this.routePointList.addItemAt({routePoint:t},i):this.routePointList.array.splice(i,0,{routePoint:t})},this.removeRoutePoint=function(t){this.routePointList.deleteItem(t.index)},MainCarInfoPanelScript.super(this),DependencesHelper.setDependences(this,t),this._mainCar=this._obstacleManager.getMainCar(),this.routePointList.renderHandler=new Handler(this,function(t,e){t.label="point"+e;var o=t.dataSource.routePoint,s=o===this._user.getSelectedRoutePoint(),a=t.getChildByName("selectedMark");null!=a&&(a.visible=s),t.on(Event.CLICK,this,i,[o]),t.on(Event.RIGHT_CLICK,this,n,[o])}),this.addRoutePointButton.on(Event.CLICK,this,function(t){var e=this._user.getSelectedSceneObject(),i=null;if(0==e.getRoutePointCount()){var n=new Pose,o=this._loadedDataManager.mapData.uiToMapPosition(this._mainPanel.mapPanel.getViewCenter());n.vec3.x=o.x,n.vec3.y=o.y,i=e.createRoutePoint(this._loadedDataManager.mapData,n),e.addRoutePoint(i)}else{var s=this._user.getSelectedRoutePoint();if(null==s)i=e.getRoutePoint(e.getRoutePointCount()-1).clone(),e.addRoutePoint(i);else{var a=s.index;i=s.clone(),e.addRoutePoint(i,a+1)}}this._user.selectRoutePoint(i)}),this.mainCarStartPointButton.dataSource={routePoint:this._mainCar.startPoint},this.mainCarStartPointButton.on(Event.CLICK,this,i,[this._mainCar.startPoint]),this._user.registerEvent(UserEvent.SCENE_OBJECT_SELECTED,this,function(t,e){this.refreshPanel()}),this._user.registerEvent(UserEvent.ROUTE_POINT_SELECTED,this,function(t,e,i){this._changePoint(e,i)}),this._mainCar.registerEvent(ObstacleEvent.ROUTE_POINT_ADDED,this,function(t,e){this.addRoutePoint(e)}),this._mainCar.registerEvent(ObstacleEvent.ROUTE_POINT_REMOVED,this,function(t,e){this.removeRoutePoint(e)}),this._mainCar.registerEvent(ObjectEvent.VALUE_CHANGED,this,function(t){this.setMainCarInfo()}),this.timeLimitInput.on(Event.ENTER,this,e),this.timeLimitInput.on(Event.BLUR,this,e),this.setMainCarInfo(),this.refreshPanel(),this._changePoint(this._user.getSelectedRoutePoint(),null)}Laya.class(MainCarInfoPanelScript,"MainCarInfoPanelScript",MainCarInfoPanelUI);